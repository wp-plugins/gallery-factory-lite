(function(b){tinymce.create("tinymce.plugins.VlsGfButtons",{init:function(a,b){a.addButton("vls_gf_album",{title:vlsGfTinymceL10n.btnInsertGFAlbum,cmd:"albumShortcode"});a.addCommand("albumShortcode",this.showAlbumSelectionDialog,{self:this,editor:a})},getInfo:function(){return{longname:"Gallery Factory Buttons",author:"Vilyon",authorurl:"http://galleryfactory.vilyon.net",infourl:"http://galleryfactory.vilyon.net",version:"1.1"}},showAlbumSelectionDialog:function(){var a=this.self,c=this.editor;c.windowManager.open({id:"vls-gf-album-shortcode-dialog",
html:'<div class="vls-gf-loading-overlay"><span></span></div>',width:500,height:.7*(b(window).height()-36-50),title:vlsGfTinymceL10n.strSelectAlbum,buttons:[{text:vlsGfTinymceL10n.btnCancel,onclick:"close"}]});b.get(ajaxurl,{action:"vls_gf_view_tinymce_album_selection_dialog"},function(b){console.log("modal loaded");a.initModalContent(b,c)},"html")},initModalContent:function(a,c){console.log("modal loaded 2");var d=b("#vls-gf-album-shortcode-dialog-body");d.empty().append(a);d.find("li.vls-gf-folder").on("click",
function(){var a=b(this);a.hasClass("vls-gf-opened")?a.children("ul").slideUp(300):a.children("ul").slideDown(300);b(this).toggleClass("vls-gf-opened");return!1});d.find("li.vls-gf-album").on("click",function(){var a=b(this).data("id");c.insertContent('[vls_gf_album id="'+a+'"]');c.windowManager.close();return!1})}});tinymce.PluginManager.add("vls_gf_buttons",tinymce.plugins.VlsGfButtons)})(jQuery);
