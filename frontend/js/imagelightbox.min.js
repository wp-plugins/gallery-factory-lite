(function(a,h,q,r){var d=function(){var b=q.body||q.documentElement,b=b.style;return""==b.WebkitTransition?"-webkit-":""==b.MozTransition?"-moz-":""==b.OTransition?"-o-":""==b.transition?"":!1},l=!1===d()?!1:!0,p=function(b,a,f){var c={},g=d();c[g+"transform"]="translateX("+a+")";c[g+"transition"]=g+"transform "+f+"s linear";b.css(c)},m="ontouchstart"in h,y=h.navigator.pointerEnabled||h.navigator.msPointerEnabled,x=function(b){if(m)return!0;if(!y||"undefined"===typeof b||"undefined"===typeof b.pointerType)return!1;
if("undefined"!==typeof b.MSPOINTER_TYPE_MOUSE){if(b.MSPOINTER_TYPE_MOUSE!=b.pointerType)return!0}else if("mouse"!=b.pointerType)return!0;return!1};a.fn.imageLightbox=function(b){b=a.extend({selector:'id="imagelightbox"',allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,preloadNext:!0,enableKeyboard:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,onStart:!1,onEnd:!1,onLoadStart:!1,onLoadEnd:!1,bottomShift:68,container:a()},b);var e=a([]),f=a(),c=a(),g=0,d=0,n=0,t=!1,r=function(c){return"a"==
a(c).prop("tagName").toLowerCase()&&(new RegExp(".("+b.allowedTypes+")$","i")).test(a(c).attr("href"))},z=function(){if(!c.length)return!0;var k=.9*a(h).width(),e=.94*(a(h).height()-b.bottomShift),f=new Image;f.src=c.attr("src");f.onload=function(){g=f.width;d=f.height;if(g>k||d>e){var p=g/d>k/e?g/k:d/e;g/=p;d/=p}c.css({width:g+"px",height:d+"px",top:(a(h).height()-d-b.bottomShift)/2+"px",left:(a(h).width()-g)/2+"px"})}},w=function(k){if(t)return!1;k="undefined"===typeof k?!1:"left"==k?1:-1;if(c.length){if(!1!==
k&&(2>e.length||!0===b.quitOnEnd&&(-1===k&&0==e.index(f)||1===k&&e.index(f)==e.length-1)))return v(),!1;var d={opacity:0};l?p(c,100*k-n+"px",b.animationSpeed/1E3):d.left=parseInt(c.css("left"))+100*k+"px";c.animate(d,b.animationSpeed,function(){A()});n=0}t=!0;if(!1!==b.onLoadStart)b.onLoadStart();setTimeout(function(){c=a("<img "+b.selector+" />").attr("src",f.attr("href")).load(function(){c.appendTo("body");z();var u={opacity:1};c.css("opacity",0);if(l)p(c,-100*k+"px",0),setTimeout(function(){p(c,
"0px",b.animationSpeed/1E3)},50);else{var d=parseInt(c.css("left"));u.left=d+"px";c.css("left",d-100*k+"px")}c.animate(u,b.animationSpeed,function(){t=!1;if(!1!==b.onLoadEnd)b.onLoadEnd()});b.preloadNext&&(u=e.eq(e.index(f)+1),u.length||(u=e.eq(0)),a("<img />").attr("src",u.attr("href")).load())}).error(function(){if(!1!==b.onLoadEnd)b.onLoadEnd()});var d=0,h=0,m=0;c.on(y?"pointerup MSPointerUp":"click",function(a){a.preventDefault();if(b.quitOnImgClick)return v(),!1;if(x(a.originalEvent))return!0;
a=(a.pageX||a.originalEvent.pageX)-a.target.offsetLeft;f=e.eq(e.index(f)-(g/2>a?1:-1));f.length||(f=e.eq(g/2>a?e.length:0));w(g/2>a?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(a){if(!x(a.originalEvent)||b.quitOnImgClick)return!0;l&&(m=parseInt(c.css("left")));d=a.originalEvent.pageX||a.originalEvent.touches[0].pageX}).on("touchmove pointermove MSPointerMove",function(a){if(!x(a.originalEvent)||b.quitOnImgClick)return!0;a.preventDefault();h=a.originalEvent.pageX||a.originalEvent.touches[0].pageX;
n=d-h;l?p(c,-n+"px",0):c.css("left",m-n+"px")}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(a){if(!x(a.originalEvent)||b.quitOnImgClick)return!0;50<Math.abs(n)?(f=e.eq(e.index(f)-(0>n?1:-1)),f.length||(f=e.eq(0>n?e.length:0)),w(0<n?"right":"left")):l?p(c,"0px",b.animationSpeed/1E3):c.animate({left:m+"px"},b.animationSpeed/2)})},b.animationSpeed+100)},A=function(){if(!c.length)return!1;c.remove();c=a()},v=function(){if(!c.length)return!1;c.animate({opacity:0},
b.animationSpeed,function(){A();t=!1;if(!1!==b.onEnd)b.onEnd()})};a(h).on("resize",z);if(b.quitOnDocClick)a(q).on(m?"touchend":"click",function(b){c.length&&!a(b.target).is(c)&&v()});if(b.enableKeyboard)a(q).on("keyup",function(a){if(!c.length)return!0;a.preventDefault();27==a.keyCode&&v();if(37==a.keyCode||39==a.keyCode)f=e.eq(e.index(f)-(37==a.keyCode?1:-1)),f.length||(f=e.eq(37==a.keyCode?e.length:0)),w(37==a.keyCode?"left":"right")});this.switchImageLightbox=function(a){var b=e.eq(a);if(b.length){var c=
e.index(f);f=b;w(a<c?"left":"right")}return this};this.quitImageLightbox=function(){v();return this};this.updateTargets=function(c,d){d||(e.each(function(){a(this).off("click.imagelightbox")}),e=a([]));c.find(".vls-gf-item a").each(function(){r(this)&&(e=e.add(a(this)))});e.on("click.imagelightbox",function(c){if(!r(this))return!0;c.preventDefault();if(t)return!1;t=!1;if(!1!==b.onStart)b.onStart();f=a(this);w()})};this.updateTargets(b.container,!1);return this}})(jQuery,window,document);
jQuery(function(a){var h=function(){a("#imagelightbox-loading").remove()},q=function(d){a('<a href="#" id="imagelightbox-close">Close</a>').appendTo("body").on("click touchend",function(){d.quitImageLightbox();return!1})},r=function(){a("#imagelightbox-info").remove()};a(".vls-gf-album").each(function(){var d=a(this),l=d.imageLightbox({container:d.find(".vls-gf-page:first-child"),onStart:function(){a('<div id="imagelightbox-overlay"></div>').appendTo("body");q(l)},onEnd:function(){r();a("#imagelightbox-close").remove();
a("#imagelightbox-overlay").remove();h()},onLoadStart:function(){r();a('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")},onLoadEnd:function(){a("#imagelightbox");var d=a('<div id="imagelightbox-info"/>'),m=a('a[href="'+a("#imagelightbox").attr("src")+'"]'),l=m.find(".vls-gf-info-caption");l&&d.append('<h2 id="imagelightbox-info-caption">'+l.text()+"</h2>");(m=m.find(".vls-gf-info-description"))&&d.append('<div id="imagelightbox-info-description">'+m.text()+"</div>");d.appendTo("body");
h()}});d.data("vlsGfLightbox",l)})});
