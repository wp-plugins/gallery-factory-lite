(function(c,m,d){c.fn.vlsGfAlbum=function(d){function y(g){function k(){"metro"==f&&d(!0)}function d(f){if(640>=c(m).width())return a.find(".vls-gf-thumbnail-container").css("height",""),!0;for(var g=a.data("vlsGfAspectRatio"),k=a.data("vlsGfHorizontalSpacing"),u=a.data("vlsGfVerticalSpacing"),h=a.data("vlsGfColumnCount"),x=Math.floor(a[0].getBoundingClientRect().width),q=[],r=0,v=-1,t=0,e=x-k*(h-1),w=Math.floor(e/h),e=e-w*h,b=0;b<h;b++)q[b]=w,0<e&&(q[b]++,e--);r=Math.round(w/g);a.find('.vls-gf-page:not(".vls-gf-hidden") .vls-gf-item').each(function(){var a=
c(this),g=a.data("vlsGfImageAspect"),f=a.data("vlsGfWidth"),d=a.data("vlsGfHeight"),e=a.data("vlsGfCol"),l=a.data("vlsGfRow"),n=0,h=0,p=0,m=0;0>v&&(v=l);l-=v;for(b=e;b<e+f;b++)n+=q[b];n+=k*(f-1);h=r*d+u*(d-1);for(b=0;b<e;b++)p+=q[b];p+=k*e;m=r*l+u*l;a.css({width:n,height:h,left:p,top:m});n/h>g?a.find("img").removeClass("vls-gf-wide").addClass("vls-gf-tall"):a.find("img").removeClass("vls-gf-tall").addClass("vls-gf-wide");t<l+d-1&&(t=l+d-1)});g=r*(t+1)+u*t;a.find(".vls-gf-thumbnail-container").css("height",
g+"px");f&&x!=parseInt(a.width())&&d(!1)}var a=c(g);g=a.data("vlsGfAlbumId");var f="";a.removeClass("no-js");a.hasClass("vls-gf-album-metro")&&(f="metro",c(m).on("resize.vls-gf-"+g,k));k();return{updateLayout:k}}var f=this;(function(){c(m).on("resize.vls-gf",function(){f.each(function(){c(this).data("vlsGfAlbum").updateLayout()})});f.each(function(){c.data(this,"vlsGfAlbum",new y(this))})})();return this};c(d).ready(function(){c(".vls-gf-album").vlsGfAlbum()})})(jQuery,window,document);
